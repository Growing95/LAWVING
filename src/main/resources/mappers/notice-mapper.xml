<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="noticeMapper">

	<resultMap id="noticeResultSet" type="NoticeVo">
		<id property="notice_idx" column="notice_idx" />
		<result property="members_idx" column="members_idx" />
		<result property="notice_title" column="notice_title" />
		<result property="notice_writer" column="notice_writer" />
		<result property="notice_content" column="notice_content" />
		<result property="notice_file_name" column="notice_file_name" />
		<result property="notice_refile_name"
			column="notice_refile_name" />
		<result property="notice_reg" column="notice_reg" />
	</resultMap>
	<!--전체목록개수 -->
	<select id="count" resultType="int">
		select count(*) from notice
	</select>

	<!-- 검색조건이 있는목록 -->
	<select id="searchCountTitle" parameterType="com.ict.lawving.notice.model.vo.NoticeSearch" resultType="int">
		select count(*) from notice
		where notice_title like '%' || #{ keyword } || '%'
	</select>
	
	<select id="searchCountContent" parameterType="com.ict.lawving.notice.model.vo.NoticeSearch" resultType="int">
		select count(*) from notice
		where notice_content like '%' || #{ keyword } || '%'
	</select>

	<!-- 목록 보기 -->
	<select id="noticelist" parameterType="map" resultMap="noticeResultSet">
		select * 
		from (select rownum r_num, a.* 
			from ( select * 
					from notice
					order by notice_idx desc 
				 ) a 
			) 
		where r_num between #{begin} and #{end}
	</select>

	<!-- 검색기능 -->
	<select id="searchTitleDesc" parameterType="map" resultMap="noticeResultSet">
		select * 
		from (select rownum r_num,a.* 
			  from(select * 
			  		from notice 
			  		where notice_title like '%' || #{ keyword } || '%'
					order by notice_idx desc
			 		) a
				) 
		where r_num between to_number(#{begin}) and to_number(#{end})
	</select>

	<select id="searchTitleAsc" parameterType="map" resultMap="noticeResultSet">
		select * 
		from (select rownum r_num,a.* 
			  from(select * 
			  		from notice 
			  		where notice_title like '%' || #{ keyword } || '%'
					order by notice_idx asc
			 		) a
				) 
		where r_num between to_number(#{begin}) and to_number(#{end})
	</select>
	
	<select id="searchContentDesc" parameterType="map"  resultMap="noticeResultSet">
		select * 
		from (select rownum r_num,a.* 
			  from(select * 
			  		from notice 
			  		where notice_content like '%' || #{ keyword } || '%'
					order by notice_idx desc
			 		) a
				) 
		where r_num between to_number(#{begin}) and to_number(#{end})
	</select>
	
	<select id="searchContentAsc" parameterType="map"  resultMap="noticeResultSet">
		select * 
		from (select rownum r_num,a.* 
			  from(select * 
			  		from notice 
			  		where notice_content like '%' || #{ keyword } || '%'
					order by notice_idx asc
			 		) a
				) 
		where r_num between to_number(#{begin}) and to_number(#{end})
	</select>
	<!-- 상세보기 -->
	<select id="selectNotice" parameterType="int" resultMap="noticeResultSet">
		select * from notice where notice_idx = #{ notice_idx }
	</select>
 	
 	<!-- 글쓰기 -->
 	<insert id="insertNotice" parameterType="int" >
		insert into notice
		values (seq_notice_idx.nextval, #{ notice_title },#{notice_writer}, #{notice_content}, 
		#{ notice_file_name })
	</insert>
</mapper>
